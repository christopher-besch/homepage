"use strict";(self.webpackChunkhomepage=self.webpackChunkhomepage||[]).push([[123],{3990:function(e,t,n){n.r(t),n.d(t,{Head:function(){return N},default:function(){return S}});var a=n(8453),l=n(6540);function r(e){const t=Object.assign({pre:"pre",code:"code",p:"p",h2:"h2",a:"a",span:"span",h3:"h3",h1:"h1"},(0,a.R)(),e.components);return l.createElement(l.Fragment,null,l.createElement(t.pre,null,l.createElement(t.code,{className:"language-bash"},'find . -name \'*.mp3\' \\\n    -printf \'echo $(exiftool -json "%p" | jq -r .[0].Track | python3 -c "print(str(int(input())).rjust(3, \\\\"0\\\\"))") "-" \' \\\n    -printf \'$(exiftool -json "%p" | jq -r .[0].Title) | \' \\\n    -printf \'mv "%p" "%h/$(tee).mp3" && \' \\\n    -printf \'echo "%p" \\n\' | \\\n        sh\n')),"\n",l.createElement(t.p,null,"Ok, let me break this down for you:"),"\n",l.createElement(t.pre,null,l.createElement(t.code,{className:"language-bash"},"find . -name '*.mp3' -printf '%p'\n")),"\n",l.createElement(t.p,null,"get's all files ending with ",l.createElement(t.code,null,".mp3")," (and directories too but I didn't bother adding ",l.createElement(t.code,null,"-type f")," to exclude them).\nThen it prints something for each file (without adding newlines between the files).\n",l.createElement(t.code,null,"%p")," gets replaced by the file's path."),"\n",l.createElement(t.p,null,"Instead of just printing the file name we print multiple commands that get piped into sh.\nEach one consists of two parts plus a cherry on top."),"\n",l.createElement(t.h2,{id:"the-first-part",style:{position:"relative"}},l.createElement(t.a,{href:"#the-first-part","aria-label":"the first part permalink",className:"anchor before"},l.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"The First Part"),"\n",l.createElement(t.p,null,"Bash replaces ",l.createElement(t.code,null,"$(some_cmd)")," with the output of ",l.createElement(t.code,null,"some_cmd"),".\nTherefore"),"\n",l.createElement(t.pre,null,l.createElement(t.code,{className:"language-bash"},'echo $(exiftool -json "%p" | jq -r .[0].Track | python3 -c "print(str(int(input())).rjust(3, \\\\"0\\\\"))") "-"\n')),"\n",l.createElement(t.p,null,"expands to the output of that big concoction plus the little dash after the last brace.\nIn bash pipes, denoted by ",l.createElement(t.code,null,"|"),", take the output of the left-hand command and input it into the right-hand one.\nThis is used to get all the metadata of our MP3 file in JSON format (",l.createElement(t.code,null,'exiftool -json "%p"'),") and extract the track number with ",l.createElement(t.code,null,"jq -r .[0].Track"),"."),"\n",l.createElement(t.p,null,"But we want to pad that number to always have three digits (",l.createElement(t.code,null,"007")," instead of ",l.createElement(t.code,null,"7"),").\nThere are thousands of different ways to do that but I didn't bother looking them up and settled for probably the most complicated one:\nWe're going to use Python!"),"\n",l.createElement(t.pre,null,l.createElement(t.code,{className:"language-bash"},"python3 -c 'print(\"Hello World\")'`\n")),"\n",l.createElement(t.p,null,"runs"),"\n",l.createElement(t.pre,null,l.createElement(t.code,{className:"language-python"},'print("Hello World")\n')),"\n",l.createElement(t.p,null,"So"),"\n",l.createElement(t.pre,null,l.createElement(t.code,{className:"language-bash"},'python3 -c "print(str(int(input())).rjust(3, \\"0\\"))"\n')),"\n",l.createElement(t.p,null,"runs (",l.createElement(t.code,null,'\\"')," gets escaped to ",l.createElement(t.code,null,'"'),")"),"\n",l.createElement(t.pre,null,l.createElement(t.code,{className:"language-python"},'print(str(int(input())).rjust(3, "0"))\n')),"\n",l.createElement(t.p,null,"which does the padding in a very, very bad way.\nBut we're not here to do clean stuff, we're here to bodge.\nTo make this run in the ",l.createElement(t.code,null,"-printf")," flag, we have to escape the ",l.createElement(t.code,null,"\\")," (which we used to escape the ",l.createElement(t.code,null,'"'),") with another ",l.createElement(t.code,null,"\\"),"."),"\n",l.createElement(t.h3,{id:"the-first-part-part-two",style:{position:"relative"}},l.createElement(t.a,{href:"#the-first-part-part-two","aria-label":"the first part part two permalink",className:"anchor before"},l.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"The First Part, Part Two"),"\n",l.createElement(t.pre,null,l.createElement(t.code,{className:"language-bash"},"-printf '$(exiftool -json \"%p\" | jq -r .[0].Title) | ' \\\n")),"\n",l.createElement(t.p,null,"Does the same as what we've just seen but with the song title, which doesn't require our Python ",l.createElement("s",null,"bodge")," magic."),"\n",l.createElement(t.p,null,"So the entire first part prints out ",l.createElement(t.code,null,"007 - song name"),"."),"\n",l.createElement(t.h2,{id:"the-second-part",style:{position:"relative"}},l.createElement(t.a,{href:"#the-second-part","aria-label":"the second part permalink",className:"anchor before"},l.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"The Second Part"),"\n",l.createElement(t.p,null,"Now we want to use this to name our MP3 file.\nTherefore we pipe the first part's output into mv.\nBut mv doesn't support pipes like that so we have to spill some tee.\nI'm terribly sorry, I mean ",l.createElement(t.code,null,"$(tee)"),".\nThe tee command does a lot of stuff but for all intents and purposes it just prints out whatever is piped into it."),"\n",l.createElement(t.p,null,"So"),"\n",l.createElement(t.pre,null,l.createElement(t.code,{className:"language-bash"},'-printf \'mv "%p" "%h/$(tee).mp3"\'\n')),"\n",l.createElement(t.p,null,"first replaces ",l.createElement(t.code,null,"%p")," with the file's original path and ",l.createElement(t.code,null,"%h")," with the path to the directory the file is located in.\nThen ",l.createElement(t.code,null,"$(tee).mp3")," get's replaced with the output of our echo command plus the file extension.\nSo it changes the name to ",l.createElement(t.code,null,"007 - song name.mp3"),"."),"\n",l.createElement(t.h2,{id:"the-cherry-on-top",style:{position:"relative"}},l.createElement(t.a,{href:"#the-cherry-on-top","aria-label":"the cherry on top permalink",className:"anchor before"},l.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"The Cherry on Top"),"\n",l.createElement(t.p,null,"Once all that has been done,"),"\n",l.createElement(t.pre,null,l.createElement(t.code,{className:"language-bash"},"-printf 'echo \"%p\" \\n'\n")),"\n",l.createElement(t.p,null,"ensures that after mv did it's business, the file path get's printed to the console, so that the user knows something is happening.\nAnd it also adds a linebreak in the end so that sh executes one command at a time."),"\n",l.createElement(t.h1,{id:"to-put-it-in-a-nutshell",style:{position:"relative"}},l.createElement(t.a,{href:"#to-put-it-in-a-nutshell","aria-label":"to put it in a nutshell permalink",className:"anchor before"},l.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"To Put it in a Nutshell"),"\n",l.createElement(t.p,null,"sh executes a list of commands that got printf-ed by find.\nIn the end these commands change the name of a file to something else.\nAnd that something else got created by echo, which is printing a string that bash expands to the track number, a ",l.createElement(t.code,null,"-")," and a string that bash expands to the song title.\nBash does that by cleaning up the output of exiftool.\nThis cleaning up is in turn being partially performed by python3, which runs a tiny Python script."),"\n",l.createElement(t.p,null,"Pretty easy, isn't it?\nGetting this one-liner to work with files that include ",l.createElement(t.code,null,"'")," and/or ",l.createElement(t.code,null,'"')," is left as an exercise to the reader."),"\n",l.createElement(t.p,null,"Oh and it might also delete files without a track number, maybe try fixing that too."))}var o=function(e){void 0===e&&(e={});const{wrapper:t}=Object.assign({},(0,a.R)(),e.components);return t?l.createElement(t,e,l.createElement(r,e)):r(e)},i=n(5365),c=n(2224),s=n(9121),h=n(4241),d=n(4810),m=n(1244),u=n(5071),p=n(9105),f=n(6897),g=n(7629),v=n(8029),E=n(1042),b=n(5526),w=n(5969);const y={AutoPlayVideo:u.A,HalfImage:p.A,Spacer:f.A,Quote:g.A,Iframe:v.A,CompareView:m.A,pre:e=>{let{children:t}=e;return l.createElement("div",{className:"code-container"}," ",l.createElement("pre",null,t))},code:e=>{let{children:t,className:n}=e;return n?l.createElement(b.A,{className:n},t):l.createElement("code",{className:"language-text"},t)},a:w.A},x=e=>{var t,n,r,o,m,u,p,f,g,v,E,b,w,x;let{data:S,children:N}=e;const _=null===(t=S.mdx)||void 0===t||null===(n=t.frontmatter)||void 0===n?void 0:n.version,T=null===(r=S.mdx)||void 0===r||null===(o=r.frontmatter)||void 0===o?void 0:o.title,k=/^0\./.test(_)?`Draft v${_}`:void 0,H=null===(m=S.mdx)||void 0===m||null===(u=m.frontmatter)||void 0===u?void 0:u.date,j=null!=(null===(p=S.mdx)||void 0===p||null===(f=p.frontmatter)||void 0===f?void 0:f.title_banner),C={"--banner-image-horizontal-position":null===(g=S.mdx)||void 0===g||null===(v=g.frontmatter)||void 0===v?void 0:v.title_banner_horizontal_position,"--banner-image-vertical-position":null===(E=S.mdx)||void 0===E||null===(b=E.frontmatter)||void 0===b?void 0:b.title_banner_vertical_position};return l.createElement(i.A,{heading:T,sub_heading:k,banner_image:j?null===(w=S.mdx)||void 0===w||null===(x=w.frontmatter)||void 0===x?void 0:x.title_banner:void 0,banner_image_style:C,small_banner:!0,banner_content:l.createElement("div",{className:`${c.yu} ${j?c.Lx:void 0}`},l.createElement("span",{className:c.cy},"Written by Christopher Besch, published on "),H)},l.createElement("div",{className:s.xo},l.createElement(a.x,{components:y},N)),l.createElement(d.N_,{className:`${h.om} ${h.nf}`,to:"/articles"},"More Articles"))};function S(e){return l.createElement(x,e,l.createElement(o,e))}const N=e=>{var t,n,a,r,o,i;let{data:c}=e;const s=null===(t=c.mdx)||void 0===t||null===(n=t.frontmatter)||void 0===n?void 0:n.title,h=null===(a=c.mdx)||void 0===a||null===(r=a.frontmatter)||void 0===r?void 0:r.description,d=null===(o=c.mdx)||void 0===o||null===(i=o.frontmatter)||void 0===i?void 0:i.banner,m=d&&"undefined"!=d?d:void 0;return l.createElement(E.A,{heading:s,description:h,banner:m})}}}]);
//# sourceMappingURL=component---src-templates-article-tsx-content-file-path-src-articles-06-bash-cmds-01-mp-3-tag-md-6ea72d9483716623c74b.js.map