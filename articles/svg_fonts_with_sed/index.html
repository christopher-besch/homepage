<!DOCTYPE html><html><head><meta charSet="UTF-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Inject Fonts into Web SVGs with sed</title><meta name="description" content=" Add font-loading CSS to SVGs with a sed script. "/><link rel="stylesheet" type="text/css" href="/styles/always.css"/><link rel="stylesheet" type="text/css" href="/styles/article.css"/></head><body><div class="layout_navbar"><a class="layout_navbar_left" href="/"><h1>Christopher Besch</h1><h2>Developer•Writer•Photographer</h2></a><div class="layout_navbar_right"><input id="layout_navbar_toggle" type="checkbox"/><label for="layout_navbar_toggle" class="layout_navbar_hamburger"><div></div><div></div><div></div></label><div class="layout_nav_links"><a href="/articles">Articles</a><a href="/photography">Photos</a><a href="/projects">Projects</a><a href="/talks">Talks</a><a href="/articles/bookmarks">Bookmarks</a><a href="/about">About</a></div></div></div><div class="layout_transient_space"><div class="layout_nav_links"><a href="/articles">Articles</a><a href="/photography">Photos</a><a href="/projects">Projects</a><a href="/talks">Talks</a><a href="/articles/bookmarks">Bookmarks</a><a href="/about">About</a></div><p>This is a transient space.</p></div><div class="layout_content_container"><div class="layout_hero" style="--layout-object-fit-h:30%;--layout-object-fit-v:25%;--layout-hero-fraction:0.7"><picture class="image_picture"><source srcSet="/images/8a91fa78321acab130bedea9f7bfec75_400_241.webp 400w,/images/8a91fa78321acab130bedea9f7bfec75_800_482.webp 800w,/images/8a91fa78321acab130bedea9f7bfec75_1200_723.webp 1200w,/images/8a91fa78321acab130bedea9f7bfec75_1600_964.webp 1600w" type="image/webp" width="400" height="241" media="(orientation: landscape)"/><source srcSet="/images/8a91fa78321acab130bedea9f7bfec75_30_400_533.webp 400w,/images/8a91fa78321acab130bedea9f7bfec75_30_800_1066.webp 800w" type="image/webp" width="400" height="533" media="(orientation: portrait) and (max-width: 500px)"/><img srcSet="/images/8a91fa78321acab130bedea9f7bfec75_400_241.webp 400w,/images/8a91fa78321acab130bedea9f7bfec75_800_482.webp 800w,/images/8a91fa78321acab130bedea9f7bfec75_1200_723.webp 1200w,/images/8a91fa78321acab130bedea9f7bfec75_1600_964.webp 1600w" width="400" height="241" style="background-image:radial-gradient(67% 67% at 25% 25%, #9ba0a0, transparent),radial-gradient(67% 67% at 50% 25%, #b2babe, transparent),radial-gradient(67% 67% at 75% 25%, #626855, transparent),radial-gradient(67% 67% at 25% 50%, #6c6e43, transparent),radial-gradient(67% 67% at 50% 50%, #6e7148, transparent),radial-gradient(67% 67% at 75% 50%, #61603c, transparent),radial-gradient(67% 67% at 25% 75%, #9a965d, transparent),radial-gradient(67% 67% at 50% 75%, #969251, transparent),radial-gradient(67% 67% at 75% 75%, #7d7142, transparent),linear-gradient(#848462);background-position:0 0, 0 100%;background-size:100% 100%;background-repeat:no-repeat" loading="eager"/></picture><div class="layout_hero_children"><div class="title_in_hero"><h1>Inject Fonts into Web SVGs with sed</h1><hr/><h2>Monday, 10th February, 2025</h2></div></div></div><div class="layout_content"><div class="article_page_markdown"><div class="markdown_body"><p>So you want to embed an SVG on your website and add this to your HTML:</p>
<pre><code class="language-html">&lt;<span class="pl-ent">object</span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>page<span class="pl-pds">&quot;</span></span> <span class="pl-e">data</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>input_svg.svg<span class="pl-pds">&quot;</span></span> <span class="pl-e">type</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>image/svg+xml<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">object</span>&gt;
</code></pre>
<p>In my case this is an Affinity Designer SVG export.</p>
<p>But now we realize that the fonts don&#x27;t work.
That&#x27;s because your pretty SVG doesn&#x27;t tell the browser where to find these fonts.
Usually you can fix this with CSS like this, making sure you actually host the <code>.woff</code> file at the specified location:</p>
<pre><code class="language-css"><span class="pl-k">@font-face</span> {
    <span class="pl-c1">font-family</span>: <span class="pl-s"><span class="pl-pds">&#x27;</span>Candara<span class="pl-pds">&#x27;</span></span>;
    <span class="pl-c1">src</span>: <span class="pl-c1">url</span>(<span class="pl-s"><span class="pl-pds">&#x27;</span>/vendor/fonts/Candara-Regular.woff<span class="pl-pds">&#x27;</span></span>)<span class="pl-c1">format</span>(<span class="pl-s"><span class="pl-pds">&#x27;</span>woff<span class="pl-pds">&#x27;</span></span>);
    <span class="pl-c1">font-weight</span>: <span class="pl-c1">normal</span>;
    <span class="pl-c1">font-style</span>: <span class="pl-c1">normal</span>;
}
</code></pre>
<p>Unfortunately this CSS can&#x27;t just be included in your HTML document, it has to be part of the SVG itself.
This is how the original SVG looks like:</p>
<pre><code class="language-svg">&lt;?<span class="pl-ent">xml</span> <span class="pl-e">version</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>1.0<span class="pl-pds">&quot;</span></span> <span class="pl-e">encoding</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>UTF-8<span class="pl-pds">&quot;</span></span> <span class="pl-e">standalone</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>no<span class="pl-pds">&quot;</span></span>?&gt;
&lt;!<span class="pl-k">DOCTYPE</span> <span class="pl-c1">svg</span> PUBLIC &quot;-//W3C//DTD SVG 1.1//EN&quot; &quot;http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd&quot;&gt;
&lt;<span class="pl-ent">svg</span> [...]&gt;
    [...]
&lt;/<span class="pl-ent">svg</span>&gt;
</code></pre>
<p>After the injection we need it to look like this:</p>
<pre><code class="language-svg">&lt;?<span class="pl-ent">xml</span> <span class="pl-e">version</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>1.0<span class="pl-pds">&quot;</span></span> <span class="pl-e">encoding</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>UTF-8<span class="pl-pds">&quot;</span></span> <span class="pl-e">standalone</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>no<span class="pl-pds">&quot;</span></span>?&gt;
&lt;!<span class="pl-k">DOCTYPE</span> <span class="pl-c1">svg</span> PUBLIC &quot;-//W3C//DTD SVG 1.1//EN&quot; &quot;http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd&quot;&gt;
&lt;<span class="pl-ent">svg</span> [...]&gt;
    &lt;<span class="pl-ent">defs</span>&gt;
        &lt;<span class="pl-ent">style</span> <span class="pl-e">type</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>text/css<span class="pl-pds">&quot;</span></span>&gt;&lt;![CDATA[
            @font-face {
                font-family: <span class="pl-s"><span class="pl-pds">&#x27;</span>Candara<span class="pl-pds">&#x27;</span></span>;
                src: url(<span class="pl-s"><span class="pl-pds">&#x27;</span>/vendor/fonts/Candara-Regular.woff<span class="pl-pds">&#x27;</span></span>)format(<span class="pl-s"><span class="pl-pds">&#x27;</span>woff<span class="pl-pds">&#x27;</span></span>);
                font-weight: normal;
                font-style: normal;
            }
        ]]<span class="pl-k">&gt;</span>&lt;/<span class="pl-ent">style</span><span class="pl-k">&gt;</span>
    &lt;/<span class="pl-ent">defs</span><span class="pl-k">&gt;</span>

    [...]
&lt;/<span class="pl-ent">svg</span><span class="pl-k">&gt;</span>
</code></pre>
<h1 id="all-hail-sed-a-stream-editor"><a aria-hidden="true" tabindex="-1" class="markdown_heading_a" href="#all-hail-sed-a-stream-editor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>All Hail sed, a <strong>s</strong>tream <strong>ed</strong>itor!</h1>
<p>So, how do we do this?</p>
<p>We have the font-loading CSS in the file <code>fonts.css</code>.
Our first challenge lies in surrounding this CSS with the required SVG stuff.</p>
<p>Let&#x27;s do this with sed and start with creating the file <code>fonts_css_template.txt</code>:</p>
<pre><code class="language-xml">&lt;<span class="pl-ent">defs</span>&gt;
    &lt;<span class="pl-ent">style</span> <span class="pl-e">type</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>text/css<span class="pl-pds">&quot;</span></span>&gt;<span class="pl-s"><span class="pl-pds">&lt;![CDATA[</span></span>
<span class="pl-s">OHtFGivqhAswi</span>
<span class="pl-s">    <span class="pl-pds">]]&gt;</span></span>&lt;/<span class="pl-ent">style</span>&gt;
&lt;/<span class="pl-ent">defs</span>&gt;
</code></pre>
<p>As you can see the (randomly chosen) string <code>OHtFGivqhAswi</code> needs to be replaced with the CSS.</p>
<pre><code class="language-bash">sed <span class="pl-s"><span class="pl-pds">&quot;</span>/OHtFGivqhAswi/e cat fonts.css<span class="pl-pds">&quot;</span></span> fonts_css_template.txt <span class="pl-k">|</span> \
    sed <span class="pl-s"><span class="pl-pds">&#x27;</span>s/OHtFGivqhAswi//<span class="pl-pds">&#x27;</span></span> \
    <span class="pl-k">&gt;</span> final_text_to_include_in_svg.txt
</code></pre>
<ol>
<li>The first sed command reads <code>fonts.css</code> and puts it right before <code>OHtFGivqhAswi</code>;</li>
<li>the second deletes <code>OHtFGivqhAswi</code>.
This only works because <code>OHtFGivqhAswi</code> is on its own line.</li>
<li>We pipe the output into <code>final_text_to_include_in_svg.txt</code>.
This is what needs to be injected into the SVG.</li>
</ol>
<h2 id="commence-the-injection"><a aria-hidden="true" tabindex="-1" class="markdown_heading_a" href="#commence-the-injection"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Commence the Injection</h2>
<pre><code class="language-bash">sed -E <span class="pl-s"><span class="pl-pds">&#x27;</span>s/(&lt;svg [^&gt;]+&gt;)/\1\ncI0WWZKD2UKEj\n/<span class="pl-pds">&#x27;</span></span> input_svg.svg <span class="pl-k">|</span> \
    sed <span class="pl-s"><span class="pl-pds">&quot;</span>/cI0WWZKD2UKEj/e cat final_text_to_include_in_svg.txt<span class="pl-pds">&quot;</span></span> <span class="pl-k">|</span> \
    sed <span class="pl-s"><span class="pl-pds">&#x27;</span>s/cI0WWZKD2UKEj//<span class="pl-pds">&#x27;</span></span> \
    <span class="pl-k">&gt;</span> output_svg.svg
</code></pre>
<ol>
<li>Our first command finds the opening <code>svg</code> tag and appends the random string <code>cI0WWZKD2UKEj</code>, making sure it is on its own line.</li>
<li>This is followed by exactly what we&#x27;ve done before: prepend what needs to be injected,</li>
<li>replace <code>cI0WWZKD2UKEj</code> and</li>
<li>pipe the output where it is needed.</li>
</ol>
<p>You don&#x27;t need that ginormous web framework for simple things—some CSS and sed does the trick just fine.
Perhaps, first take a look at what the GNU toolbox offers when solving the next challenge you come across.</p>
<h2 id="the-final-script"><a aria-hidden="true" tabindex="-1" class="markdown_heading_a" href="#the-final-script"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><a href="https://github.com/SelinaStrobel/homepage/blob/main/fonts_loader/load_fonts_in_css.sh">The Final Script</a></h2>
<pre><code class="language-bash"><span class="pl-c">#!/bin/bash</span>
<span class="pl-c1">set</span> -euo pipefail
DIR=<span class="pl-s"><span class="pl-pds">&quot;$(</span>cd <span class="pl-pds">&quot;$(</span>dirname <span class="pl-pds">&quot;</span><span class="pl-smi">${BASH_SOURCE[0]}</span><span class="pl-pds">&quot;)&quot;</span> <span class="pl-k">&gt;</span>/dev/null <span class="pl-k">2&gt;&amp;1</span> <span class="pl-k">&amp;&amp;</span> pwd<span class="pl-pds">)&quot;</span></span>

FONTS_CSS_TEMPLATE=<span class="pl-s"><span class="pl-pds">&quot;</span><span class="pl-smi">$DIR</span>/fonts_css_template.txt<span class="pl-pds">&quot;</span></span>
FINAL_TEXT_TO_INCLUDE_IN_SVG=<span class="pl-s"><span class="pl-pds">&quot;</span><span class="pl-smi">$DIR</span>/final_text_to_include_in_svg.txt<span class="pl-pds">&quot;</span></span>
FONTS_CSS_FILE=<span class="pl-s"><span class="pl-pds">&quot;</span><span class="pl-smi">$DIR</span>/fonts.css<span class="pl-pds">&quot;</span></span>

<span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">&quot;</span>converting <span class="pl-smi">$1</span> to <span class="pl-smi">$2</span><span class="pl-pds">&quot;</span></span>

sed <span class="pl-s"><span class="pl-pds">&quot;</span>/OHtFGivqhAswi/e cat <span class="pl-smi">$FONTS_CSS_FILE</span><span class="pl-pds">&quot;</span></span> <span class="pl-s"><span class="pl-pds">&quot;</span><span class="pl-smi">$FONTS_CSS_TEMPLATE</span><span class="pl-pds">&quot;</span></span> <span class="pl-k">|</span> \
    sed <span class="pl-s"><span class="pl-pds">&#x27;</span>s/OHtFGivqhAswi//<span class="pl-pds">&#x27;</span></span> \
    <span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">&quot;</span><span class="pl-smi">$FINAL_TEXT_TO_INCLUDE_IN_SVG</span><span class="pl-pds">&quot;</span></span>

sed -E <span class="pl-s"><span class="pl-pds">&#x27;</span>s/(&lt;svg [^&gt;]+&gt;)/\1\ncI0WWZKD2UKEj\n/<span class="pl-pds">&#x27;</span></span> <span class="pl-s"><span class="pl-pds">&quot;</span><span class="pl-smi">$1</span><span class="pl-pds">&quot;</span></span> <span class="pl-k">|</span> \
    sed <span class="pl-s"><span class="pl-pds">&quot;</span>/cI0WWZKD2UKEj/e cat <span class="pl-smi">$FINAL_TEXT_TO_INCLUDE_IN_SVG</span><span class="pl-pds">&quot;</span></span> <span class="pl-k">|</span> \
    sed <span class="pl-s"><span class="pl-pds">&#x27;</span>s/cI0WWZKD2UKEj//<span class="pl-pds">&#x27;</span></span> \
    <span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">&quot;</span><span class="pl-smi">$2</span><span class="pl-pds">&quot;</span></span>
</code></pre>
<p>Save this as <code>load_fonts_in_css.sh</code>, run:</p>
<pre><code class="language-bash">chmod +x ./load_fonts_in_css.sh
./load_fonts_in_css.sh input_svg.svg output_svg.svg
</code></pre><div class="markdown_spacer"></div></div></div></div></div><div class="layout_footer"><a href="/about">Contact</a><a href="/rss.xml">RSS</a><a href="/privacy">Privacy</a><div>© 2025 | All rights reserved</div></div></body></html>